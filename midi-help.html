<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIDI Interface Help - RGLR GNRTR</title>
    <link rel="stylesheet" href="tailwind.css">
    <style>
        /* Help page specific styles that complement the main CSS */
        .help-layout {
            display: flex;
            gap: 16px;
            max-width: 1600px;
            margin: 0 auto;
            /* Add centering back */
        }

        .help-container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .help-sidebar {
            width: 280px;
            background: var(--color-bg-overlay);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            backdrop-filter: blur(10px);
            border: 1px solid var(--color-border-primary);
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .help-main-content {
            flex: 1;
            background: var(--color-bg-overlay);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            backdrop-filter: blur(10px);
            border: 1px solid var(--color-border-primary);
        }

        .nav-section {
            margin-bottom: var(--spacing-xl);
        }

        .nav-section-title {
            color: var(--color-primary);
            font-weight: 600;
            font-size: var(--text-lg);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-sm);
            border-bottom: 1px solid var(--color-primary);
        }

        .nav-item {
            display: block;
            padding: var(--spacing-sm) var(--spacing-md);
            margin: var(--spacing-xs) 0;
            color: var(--color-text-primary);
            text-decoration: none;
            border-radius: var(--radius-md);
            transition: all 0.3s ease;
            font-size: var(--text-sm);
        }

        .nav-item:hover {
            background: rgba(139, 92, 246, 0.2);
            color: var(--color-primary);
        }

        .nav-item.active {
            background: rgba(139, 92, 246, 0.3);
            color: var(--color-primary);
            font-weight: 600;
        }

        @media (max-width: 1024px) {
            .help-layout {
                flex-direction: column;
            }

            .help-sidebar {
                width: 100%;
                position: static;
            }
        }
    </style>
</head>

<body class="help-body">
    <div class="help-container">
        <div class="help-layout">
            <!-- Sidebar Navigation -->
            <div class="help-sidebar">
                <h3 class="nav-section-title">Table of Contents</h3>

                <div class="nav-section">
                    <h4 class="nav-section-title">Getting Started</h4>
                    <a href="#getting-started" class="nav-item">Getting Started</a>
                    <a href="#connection" class="nav-item">Connection</a>
                </div>

                <div class="nav-section">
                    <h4 class="nav-section-title">MIDI Controls</h4>
                    <a href="#cc-mappings" class="nav-item">CC Mappings</a>
                    <a href="#note-controls" class="nav-item">Note Controls</a>
                    <a href="#midi-learn" class="nav-item">MIDI Learn</a>
                    <a href="#special-controls" class="nav-item">Special Controls</a>
                </div>

                <div class="nav-section">
                    <h4 class="nav-section-title">Parameters</h4>
                    <a href="#parameter-reference" class="nav-item">Parameter Reference</a>
                    <a href="#animation-params" class="nav-item">Animation Parameters</a>
                    <a href="#center-scaling-params" class="nav-item">3D Center Scaling</a>
                    <a href="#grid-params" class="nav-item">Grid Parameters</a>
                    <a href="#material-params" class="nav-item">Material Parameters</a>
                    <a href="#post-processing-params" class="nav-item">Post-Processing</a>
                    <a href="#color-params" class="nav-item">Color Parameters</a>
                    <a href="#lighting-params" class="nav-item">Lighting Parameters</a>
                </div>

                <div class="nav-section">
                    <h4 class="nav-section-title">Presets</h4>
                    <a href="#preset-management" class="nav-item">Preset Management</a>
                    <a href="#built-in-presets" class="nav-item">Built-in Presets</a>
                    <a href="#custom-presets" class="nav-item">Creating Custom Presets</a>
                </div>

                <div class="nav-section">
                    <h4 class="nav-section-title">Effects</h4>
                    <a href="#post-processing-effects" class="nav-item">Post-Processing Effects</a>
                </div>

                <div class="nav-section">
                    <h4 class="nav-section-title">Help</h4>
                    <a href="#performance-tips" class="nav-item">Performance Tips</a>
                    <a href="#troubleshooting" class="nav-item">Troubleshooting</a>
                </div>
            </div>

            <!-- Main Content -->
            <div class="help-main-content">
                <h1 class="help-h1">MIDI Interface Guide</h1>

                <!-- Getting Started Section -->
                <div id="getting-started" class="help-section">
                    <h2 class="help-h2">Getting Started</h2>
                    <p>This application supports Web MIDI API for real-time control of visual parameters. You can
                        connect any MIDI device (keyboard, controller, etc.) to control the animation and visual
                        effects.</p>

                    <div class="help-note">
                        <strong>Note:</strong> Web MIDI API requires HTTPS in most browsers. Make sure you're running
                        the application over HTTPS or localhost.
                    </div>
                </div>

                <div id="connection" class="help-section">
                    <h2 class="help-h2">Connection</h2>
                    <ol>
                        <li>Connect your MIDI device to your computer</li>
                        <li>Click the "Connect MIDI" button in the MIDI interface panel</li>
                        <li>Allow MIDI access when prompted by your browser</li>
                        <li>The status should change to "Connected" with a green indicator</li>
                    </ol>
                </div>

                <!-- CC Mappings Section -->
                <div id="cc-mappings" class="help-section">
                    <h2 class="help-h2">Control Change (CC) Mappings</h2>
                    <p>These controls use continuous values (0-127) for smooth parameter control. Each parameter can be
                        assigned to any MIDI channel (1-16) and CC number (0-127).</p>

                    <div class="help-note">
                        <strong>Note:</strong> MIDI channels are numbered 1-16 in the interface to match standard MIDI
                        hardware conventions, but internally the system uses channels 0-15.
                    </div>

                    <div class="help-note">
                        <strong>Dynamic Controls:</strong> You can add new CC controls using the "+ Add New CC Control"
                        button. Each new control will be automatically numbered and can be removed using the × button.
                    </div>

                    <div class="help-note">
                        <strong>No Default Mappings:</strong> This application does not include any pre-configured MIDI
                        mappings. All mappings must be created manually by the user through the MIDI interface.
                    </div>
                </div>

                <!-- Note Controls Section -->
                <div id="note-controls" class="help-section">
                    <h2 class="help-h2">Note Controls</h2>
                    <p>These controls use MIDI notes as toggle switches:</p>

                    <div class="help-note">
                        <strong>Dynamic Controls:</strong> You can add new Note controls using the "+ Add New Note
                        Control" button. Each new control will be automatically numbered and can be removed using the ×
                        button.
                    </div>

                    <div class="help-note">
                        <strong>No Default Note Mappings:</strong> This application does not include any pre-configured
                        MIDI note mappings. All note mappings must be created manually by the user through the MIDI
                        interface.
                    </div>

                    <div class="help-section">
                        <h3 class="help-h3">Animation Toggles</h3>
                        <ul>
                            <li><strong>Toggle Shape Cycling:</strong> Toggle shape cycling animation on/off</li>
                            <li><strong>Toggle Size Animation:</strong> Toggle size/movement/rotation animations on/off
                            </li>
                            <li><strong>Reset Animation:</strong> Reset all animations to default values</li>
                        </ul>
                    </div>

                    <div class="help-section">
                        <h3 class="help-h3">Display Toggles</h3>
                        <ul>
                            <li><strong>Toggle Grid:</strong> Toggle grid line visibility on/off</li>
                            <li><strong>Toggle Basic Shapes:</strong> Toggle basic shape visibility on/off</li>
                            <li><strong>Toggle Triangles:</strong> Toggle triangle shape visibility on/off</li>
                            <li><strong>Toggle Rectangles:</strong> Toggle rectangle shape visibility on/off</li>
                            <li><strong>Toggle Ellipses:</strong> Toggle ellipse shape visibility on/off</li>
                            <li><strong>Toggle Refractive Spheres:</strong> Toggle refractive sphere visibility on/off
                            </li>
                        </ul>
                    </div>

                    <div class="help-section">
                        <h3 class="help-h3">Post-Processing Toggles</h3>
                        <ul>
                            <li><strong>Toggle Bloom:</strong> Toggle bloom glow effect on/off</li>
                            <li><strong>Toggle Chromatic Aberration:</strong> Toggle color separation effect on/off</li>
                            <li><strong>Toggle Vignette:</strong> Toggle edge darkening effect on/off</li>
                            <li><strong>Toggle Film Grain:</strong> Toggle film grain noise effect on/off</li>
                            <li><strong>Toggle Color Grading:</strong> Toggle color grading effects on/off</li>
                            <li><strong>Toggle Post Processing:</strong> Toggle all post-processing effects on/off</li>
                        </ul>
                    </div>

                    <div class="help-note">
                        <strong>Note:</strong> Any other MIDI note will control cell size based on velocity (how hard
                        you press the key).
                    </div>
                </div>

                <!-- MIDI Learn Section -->
                <div id="midi-learn" class="help-section">
                    <h2 class="help-h2">MIDI Learn Functionality</h2>
                    <p>New controls feature a "Learn" button that automatically detects MIDI input:</p>
                    <ol>
                        <li>Click the "Learn" button on any control</li>
                        <li>Send a MIDI CC or Note message from your device</li>
                        <li>The system will automatically detect the channel and CC/Note number</li>
                        <li>The control will be configured and ready to use</li>
                    </ol>

                    <div class="help-note">
                        <strong>Note:</strong> The Learn function works for both CC and Note controls. For CC controls,
                        it learns the CC number and channel. For Note controls, it learns the note number and channel.
                    </div>
                </div>

                <!-- Special Controls Section -->
                <div id="special-controls" class="help-section">
                    <h2 class="help-h2">Special Controls</h2>
                    <ul>
                        <li><strong>Pitch Bend:</strong> Controls animation type (0-3: Movement, Rotation, Scale,
                            Combined)</li>
                        <li><strong>Aftertouch/Channel Pressure:</strong> Controls shape color intensity (grayscale)
                        </li>
                    </ul>
                </div>

                <!-- Parameter Reference Section -->
                <div id="parameter-reference" class="help-section">
                    <h2 class="help-h2">Parameter Reference</h2>
                    <p>This section provides a comprehensive reference for all available parameters that can be mapped
                        to MIDI controls:</p>

                    <div id="animation-params" class="help-section">
                        <h3 class="help-h3">Animation Parameters</h3>
                        <ul>
                            <li><strong>animationSpeed:</strong> Controls the overall animation speed</li>
                            <li><strong>movementAmplitude:</strong> Controls the amplitude of movement</li>
                            <li><strong>rotationAmplitude:</strong> Controls the amplitude of rotation</li>
                            <li><strong>scaleAmplitude:</strong> Controls the amplitude of scaling</li>
                            <li><strong>randomness:</strong> Controls the randomness of animations</li>
                            <li><strong>cellSize:</strong> Controls the size of individual cells</li>
                            <li><strong>movementFrequency:</strong> Controls the frequency of movement</li>
                            <li><strong>rotationFrequency:</strong> Controls the frequency of rotation</li>
                            <li><strong>scaleFrequency:</strong> Controls the frequency of scaling</li>
                        </ul>
                    </div>

                    <div id="center-scaling-params" class="help-section">
                        <h3 class="help-h3">3D Center Scaling Parameters</h3>
                        <p>These parameters control the 3D depth effect by scaling shapes based on their distance from the center of the grid:</p>
                        <ul>
                            <li><strong>centerScalingEnabled:</strong> Toggles the 3D center scaling effect on/off</li>
                            <li><strong>centerScalingIntensity:</strong> Controls the strength of the scaling effect (0-2)</li>
                            <li><strong>centerScalingCurve:</strong> Selects the scaling curve function:
                                <ul>
                                    <li><strong>0 - Linear:</strong> Uniform scaling from center to edge</li>
                                    <li><strong>1 - Exponential:</strong> Sharp scaling near center, gradual at edges</li>
                                    <li><strong>2 - Logarithmic:</strong> Gradual scaling near center, sharp at edges</li>
                                    <li><strong>3 - Sine Wave:</strong> Smooth wave-like scaling pattern</li>
                                </ul>
                            </li>
                            <li><strong>centerScalingRadius:</strong> Controls the maximum distance where scaling applies (0.1-5)</li>
                            <li><strong>centerScalingDirection:</strong> Controls the scaling direction:
                                <ul>
                                    <li><strong>0 - Convex:</strong> Shapes larger at center, smaller at edges (dome effect)</li>
                                    <li><strong>1 - Concave:</strong> Shapes smaller at center, larger at edges (bowl effect)</li>
                                </ul>
                            </li>
                            <li><strong>centerScalingAnimation:</strong> Enables animated scaling effects</li>
                            <li><strong>centerScalingAnimationSpeed:</strong> Controls the speed of animated scaling (0.1-3)</li>
                        </ul>
                        
                        <div class="help-note">
                            <strong>Visual Effects:</strong> The center scaling system creates depth perception by making shapes appear closer or further away based on their position relative to the grid center. This creates a 3D effect on an otherwise 2D grid.
                        </div>
                    </div>

                    <div id="grid-params" class="help-section">
                        <h3 class="help-h3">Grid Parameters</h3>
                        <ul>
                            <li><strong>gridWidth:</strong> Controls the width of the grid</li>
                            <li><strong>gridHeight:</strong> Controls the height of the grid</li>
                            <li><strong>compositionWidth:</strong> Controls the composition width</li>
                            <li><strong>compositionHeight:</strong> Controls the composition height</li>
                        </ul>
                    </div>

                    <div id="material-params" class="help-section">
                        <h3 class="help-h3">Material Parameters</h3>
                        <ul>
                            <li><strong>sphereRefraction:</strong> Controls sphere refraction</li>
                            <li><strong>sphereTransparency:</strong> Controls sphere transparency</li>
                            <li><strong>sphereTransmission:</strong> Controls sphere transmission</li>
                            <li><strong>sphereRoughness:</strong> Controls sphere roughness</li>
                            <li><strong>sphereMetalness:</strong> Controls sphere metalness</li>
                            <li><strong>sphereScale:</strong> Controls sphere scale</li>
                            <li><strong>sphereClearcoat:</strong> Controls sphere clearcoat</li>
                            <li><strong>sphereClearcoatRoughness:</strong> Controls sphere clearcoat roughness</li>
                            <li><strong>sphereEnvMapIntensity:</strong> Controls sphere environment map intensity</li>
                        </ul>
                    </div>

                    <div id="post-processing-params" class="help-section">
                        <h3 class="help-h3">Post-Processing Parameters</h3>
                        <ul>
                            <li><strong>bloomStrength:</strong> Controls bloom strength</li>
                            <li><strong>bloomRadius:</strong> Controls bloom radius</li>
                            <li><strong>bloomThreshold:</strong> Controls bloom threshold</li>
                            <li><strong>chromaticIntensity:</strong> Controls chromatic aberration intensity</li>
                            <li><strong>vignetteIntensity:</strong> Controls vignette intensity</li>
                            <li><strong>vignetteRadius:</strong> Controls vignette radius</li>
                            <li><strong>vignetteSoftness:</strong> Controls vignette softness</li>
                            <li><strong>grainIntensity:</strong> Controls film grain intensity</li>
                        </ul>
                    </div>

                    <div id="color-params" class="help-section">
                        <h3 class="help-h3">Color Parameters</h3>
                        <ul>
                            <li><strong>colorHue:</strong> Controls color hue</li>
                            <li><strong>colorSaturation:</strong> Controls color saturation</li>
                            <li><strong>colorBrightness:</strong> Controls color brightness</li>
                            <li><strong>colorContrast:</strong> Controls color contrast</li>
                        </ul>
                    </div>

                    <div id="lighting-params" class="help-section">
                        <h3 class="help-h3">Lighting Parameters</h3>
                        <ul>
                            <li><strong>ambientLightIntensity:</strong> Controls ambient light intensity</li>
                            <li><strong>directionalLightIntensity:</strong> Controls directional light intensity</li>
                            <li><strong>pointLight1Intensity:</strong> Controls point light 1 intensity</li>
                            <li><strong>pointLight2Intensity:</strong> Controls point light 2 intensity</li>
                            <li><strong>rimLightIntensity:</strong> Controls rim light intensity</li>
                            <li><strong>accentLightIntensity:</strong> Controls accent light intensity</li>
                        </ul>
                    </div>
                </div>

                <!-- Preset Management Section -->
                <div id="preset-management" class="help-section">
                    <h2 class="help-h2">Preset Management</h2>
                    <p>You can save and load custom MIDI mapping presets:</p>
                    <ul>
                        <li><strong>Save Preset:</strong> Exports your current MIDI mappings to a JSON file</li>
                        <li><strong>Load Preset:</strong> Imports a previously saved preset file</li>
                        <li><strong>Built-in Presets:</strong> Quick access to common mapping configurations</li>
                    </ul>

                    <div class="help-note">
                        <strong>Preset File Format:</strong> Presets are saved as JSON files with the following
                        structure:
                        <pre class="help-pre">{
  "name": "Preset Name",
  "description": "Description",
  "version": "1.0",
  "created": "2024-01-15T10:30:00Z",
  "midiCCMappings": {
    "cc1": { "channel": 0, "value": 1, "target": "animationSpeed" },
    "cc2": { "channel": 1, "value": 1, "target": "movementAmplitude" }
  },
  "midiNoteMappings": {
    "note1": { "channel": 0, "note": 60, "target": "shapeCycling" },
    "note2": { "channel": 0, "note": 61, "target": "sizeAnimation" }
  }
}</pre>
                    </div>
                </div>

                <!-- Built-in Presets Section -->
                <div id="built-in-presets" class="help-section">
                    <h2 class="help-h2">Available Built-in Presets</h2>
                    <p>The application includes several pre-configured presets optimized for different MIDI controllers:
                    </p>

                    <div class="help-section">
                        <h4 class="help-h3">Sample Multi-Channel Preset</h4>
                        <p>A sample preset that uses different MIDI channels for each parameter. Useful for testing and
                            understanding the mapping structure.</p>
                    </div>

                    <div class="help-section">
                        <h4 class="help-h3">Novation Launch Control XL</h4>
                        <p>Optimized for Novation Launch Control XL with 8 rotary encoders and 16 buttons. Maps the most
                            commonly used parameters to the available controls.</p>
                        <ul>
                            <li>Uses CC numbers 13-48 for rotary encoders</li>
                            <li>Uses note numbers 36-50 for buttons</li>
                            <li>All controls on channel 0</li>
                        </ul>
                    </div>

                    <div class="help-section">
                        <h4 class="help-h3">Akai MPK Mini</h4>
                        <p>Optimized for Akai MPK Mini with 8 pads and 4 rotary encoders. Focuses on the most essential
                            parameters for live performance.</p>
                        <ul>
                            <li>Uses CC numbers 1-36 for rotary encoders</li>
                            <li>Uses note numbers 36-50 for pads</li>
                            <li>All controls on channel 0</li>
                        </ul>
                    </div>

                    <div class="help-section">
                        <h4 class="help-h3">Arturia BeatStep Pro</h4>
                        <p>Optimized for Arturia BeatStep Pro with 16 rotary encoders and 16 pads. Comprehensive mapping
                            for full control over all parameters.</p>
                        <ul>
                            <li>Uses CC numbers 1-41 for rotary encoders</li>
                            <li>Uses note numbers 36-50 for pads</li>
                            <li>All controls on channel 0</li>
                        </ul>
                    </div>
                </div>

                <!-- Creating Custom Presets Section -->
                <div id="custom-presets" class="help-section">
                    <h2 class="help-h2">Creating Custom Presets</h2>
                    <ol>
                        <li>Set up your MIDI mappings in the application</li>
                        <li>Use the "Save Preset" function to download your current mappings</li>
                        <li>Copy the downloaded file to the presets folder</li>
                        <li>Rename it to something descriptive (e.g., `my-controller-name.json`)</li>
                    </ol>
                </div>

                <!-- Post-Processing Effects Section -->
                <div id="post-processing-effects" class="help-section">
                    <h2 class="help-h2">Post-Processing Effects</h2>
                    <p>The application includes advanced post-processing effects that can be controlled via MIDI:</p>

                    <h3 class="help-h3">Bloom Effect</h3>
                    <ul>
                        <li><strong>Bloom Strength:</strong> Controls the intensity of the glow effect around bright
                            areas</li>
                        <li><strong>Bloom Radius:</strong> Controls the size and spread of the bloom effect</li>
                        <li><strong>Bloom Threshold:</strong> Sets the brightness level at which bloom begins</li>
                    </ul>

                    <h3 class="help-h3">Chromatic Aberration</h3>
                    <ul>
                        <li><strong>Chromatic Intensity:</strong> Controls the amount of color separation effect</li>
                    </ul>

                    <h3 class="help-h3">Vignette Effect</h3>
                    <ul>
                        <li><strong>Vignette Intensity:</strong> Controls the darkness of the edge effect</li>
                        <li><strong>Vignette Radius:</strong> Controls the size of the vignette area</li>
                        <li><strong>Vignette Softness:</strong> Controls the softness of the vignette edges</li>
                    </ul>

                    <h3 class="help-h3">Film Grain</h3>
                    <ul>
                        <li><strong>Grain Intensity:</strong> Controls the amount of film grain noise</li>
                    </ul>

                    <h3 class="help-h3">Color Grading</h3>
                    <ul>
                        <li><strong>Color Hue:</strong> Shifts the overall hue of the scene</li>
                        <li><strong>Color Saturation:</strong> Controls the intensity of colors</li>
                        <li><strong>Color Brightness:</strong> Adjusts the overall brightness</li>
                        <li><strong>Color Contrast:</strong> Controls the contrast between light and dark areas</li>
                    </ul>

                    <h3 class="help-h3">FXAA Anti-Aliasing</h3>
                    <ul>
                        <li><strong>FXAA Enabled:</strong> Toggles fast approximate anti-aliasing for smoother edges
                        </li>
                    </ul>
                </div>

                <!-- Performance Tips Section -->
                <div id="performance-tips" class="help-section">
                    <h2 class="help-h2">Tips for Performance</h2>
                    <ul>
                        <li>Use a MIDI controller with knobs/sliders for smooth CC control</li>
                        <li>Map frequently used parameters to easily accessible controls</li>
                        <li>Use velocity-sensitive keys for dynamic cell size control</li>
                        <li>Experiment with different CC mappings to find your preferred setup</li>
                        <li>Post-processing effects can be CPU intensive - disable unused effects for better performance
                        </li>
                        <li>Use FXAA for smoother visuals without significant performance impact</li>
                    </ul>
                </div>

                <!-- Troubleshooting Section -->
                <div id="troubleshooting" class="help-section">
                    <h2 class="help-h2">Troubleshooting</h2>
                    <div class="help-warning">
                        <strong>MIDI not connecting?</strong>
                        <ul>
                            <li>Make sure your MIDI device is properly connected and recognized by your OS</li>
                            <li>Try refreshing the page and reconnecting</li>
                            <li>Check that your browser supports Web MIDI API (Chrome, Edge, Firefox)</li>
                            <li>Ensure you're running over HTTPS or localhost</li>
                        </ul>
                    </div>

                    <div class="help-warning">
                        <strong>Performance issues?</strong>
                        <ul>
                            <li>Disable post-processing effects if experiencing lag</li>
                            <li>Reduce the number of active shapes or grid size</li>
                            <li>Lower animation frequencies for smoother performance</li>
                            <li>Close other browser tabs to free up resources</li>
                        </ul>
                    </div>
                </div>

                
            </div>
        </div>
    </div>

    <script>
        // Smooth scrolling for navigation links
        document.querySelectorAll('.nav-item').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href').substring(1);
                const targetElement = document.getElementById(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Highlight active section in navigation
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('.help-section');
            const navLinks = document.querySelectorAll('.nav-item');

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (window.pageYOffset >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>

</html>